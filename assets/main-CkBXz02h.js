import{o as v,d as B,a as y,g as p,b as P,l as k}from"./auth-cbFyKSDW.js";document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("navLoginContainer"),d=document.getElementById("navProfileContainer"),L=document.getElementById("profileDropdownBtn"),s=document.getElementById("navProfileImg"),c=document.getElementById("navProfileIcon"),t=document.getElementById("profileDropdownMenu"),r=document.getElementById("closeDropdownBtn"),o=document.getElementById("menuProfileImg"),m=document.getElementById("menuProfileIcon"),l=document.getElementById("menuUserName"),I=document.getElementById("menuUserEmail"),u=document.getElementById("menuSignOutBtn");v(P,async e=>{if(e){i.classList.add("hidden"),d.classList.remove("hidden"),I.innerText=e.email,l.innerText=e.displayName||"Student";try{const a=B(y,"users",e.uid),f=await p(a);if(f.exists()){const n=f.data().settings||{},E=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,h=n.theme||(n.darkMode===!0?"dark":null);h==="dark"?document.documentElement.classList.add("dark"):h==="light"?document.documentElement.classList.remove("dark"):E?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),n.userFirstName&&(l.innerText=n.userFirstName),n.userProfileImage?(s.src=n.userProfileImage,s.classList.remove("hidden"),c.classList.add("hidden"),o.src=n.userProfileImage,o.classList.remove("hidden"),m.classList.add("hidden")):g()}}catch(a){console.error("Profile load error:",a),g()}}else i.classList.remove("hidden"),d.classList.add("hidden"),t.classList.add("hidden")}),L.addEventListener("click",e=>{e.stopPropagation(),t.classList.remove("hidden")}),r&&r.addEventListener("click",e=>{e.stopPropagation(),t.classList.add("hidden")}),document.addEventListener("click",e=>{d.contains(e.target)||t.classList.add("hidden")}),u&&u.addEventListener("click",async()=>{await k(),t.classList.add("hidden")});function g(){s.classList.add("hidden"),c.classList.remove("hidden"),o.classList.add("hidden"),m.classList.remove("hidden")}});
