const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/store-BI9LHzMQ.js","assets/auth-cbFyKSDW.js","assets/store-C7ZCaNIq.css"])))=>i.map(i=>d[i]);
import{o as X,b as Z,l as ee}from"./auth-cbFyKSDW.js";import{userData as c,parseSlotData as E,saveUserData as v,appState as W,loadUserData as te,setCurrentUser as ne}from"./store-BI9LHzMQ.js";document.addEventListener("DOMContentLoaded",()=>{oe();const e=document.getElementById("retryLocationBtn"),n=document.getElementById("closeLocationModal");e&&e.addEventListener("click",()=>{O();const o=document.getElementById("settingWeatherToggle");o&&(o.checked=!0,ae())}),n&&n.addEventListener("click",O)});function oe(){const e=localStorage.getItem("isWeatherEnabled")==="true",n=document.getElementById("settingWeatherToggle");n&&(n.checked=e),e?de():D()}function ae(e){const n=document.getElementById("settingWeatherToggle");n&&(n.disabled=!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(o=>{n&&(n.disabled=!1,n.checked=!0),localStorage.setItem("isWeatherEnabled","true");const t=o.coords.latitude,d=o.coords.longitude;V(t,d),_(t,d),j()},o=>{console.warn("Location access denied."),n&&(n.disabled=!1,n.checked=!1),localStorage.setItem("isWeatherEnabled","false"),D(),re()}):(alert("Geolocation is not supported by this browser."),n&&(n.disabled=!1,n.checked=!1))}function de(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{j(),V(e.coords.latitude,e.coords.longitude),_(e.coords.latitude,e.coords.longitude)},e=>{console.log("Weather enabled but permission missing."),D()})}function V(e,n){const o=`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${n}&current_weather=true`;fetch(o).then(t=>t.json()).then(t=>{t.current_weather&&se(t.current_weather)}).catch(t=>console.error("Weather fetch failed",t))}function _(e,n){const o=`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${e}&longitude=${n}&localityLanguage=en`;fetch(o).then(t=>t.json()).then(t=>{const d=t.city||t.locality||"Local Weather",i=t.countryName||"",a=document.getElementById("weatherCity");a&&(i?a.innerText=`${d}, ${i}`:a.innerText=d)}).catch(t=>console.error("Location lookup failed",t))}function se(e){const n=Math.round(e.temperature),o=e.weathercode,t=e.is_day===1;document.getElementById("weatherTemp").innerText=`${n}Â°`,document.getElementById("weatherDesc").innerText=le(o),document.getElementById("weatherIcon").innerText=ce(o,t),ie(t,o)}function ie(e,n){const o=document.querySelector(".weather-card");if(!o)return;let t="";e?(n>=95?t="linear-gradient(135deg, #4b5563 0%, #1f2937 100%)":n>=51?t="linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%)":n>=1&&n<=3?t="linear-gradient(135deg, #93c5fd 0%, #60a5fa 100%)":t="linear-gradient(135deg, #fcd34d 0%, #fbbf24 100%)",n===0&&(t="linear-gradient(135deg, #38bdf8 0%, #818cf8 100%)")):n>=95?t="linear-gradient(135deg, #1f2937 0%, #000000 100%)":n>=51?t="linear-gradient(135deg, #1e3a8a 0%, #172554 100%)":t="linear-gradient(135deg, #312e81 0%, #1e1b4b 100%)",o.style.background=t}function j(){const e=document.getElementById("weatherContainer");e&&e.classList.remove("hidden")}function D(){const e=document.getElementById("weatherContainer");e&&e.classList.add("hidden")}function re(){const e=document.getElementById("locationModal");e&&(e.classList.remove("hidden"),e.classList.add("flex"))}function O(){const e=document.getElementById("locationModal");e&&(e.classList.add("hidden"),e.classList.remove("flex"))}function le(e){return{0:"Sunny",1:"Mainly Clear",2:"Partly Cloudy",3:"Overcast",45:"Foggy",48:"Rime Fog",51:"Light Drizzle",53:"Drizzle",55:"Heavy Drizzle",61:"Light Rain",63:"Rain",65:"Heavy Rain",71:"Light Snow",73:"Snow",75:"Heavy Snow",80:"Rain Showers",81:"Showers",82:"Violent Showers",95:"Thunderstorm",96:"Thunderstorm",99:"Heavy Thunderstorm"}[e]||"Unknown"}function ce(e,n=!0){return e===0?n?"sunny":"bedtime":e>=1&&e<=3?n?"partly_cloudy_day":"nights_stay":e>=45&&e<=48?"foggy":e>=51&&e<=67?"rainy":e>=71&&e<=77?"weather_snowy":e>=80&&e<=82?"rainy":e>=95?"thunderstorm":"cloud"}window.jsPDF=window.jspdf.jsPDF;const ue="modulepreload",me=function(e){return"/"+e},A={},ge=function(n,o,t){let d=Promise.resolve();if(o&&o.length>0){let r=function(l){return Promise.all(l.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),s=a?.nonce||a?.getAttribute("nonce");d=r(o.map(l=>{if(l=me(l),l in A)return;A[l]=!0;const m=l.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${g}`))return;const u=document.createElement("link");if(u.rel=m?"stylesheet":ue,m||(u.as="script"),u.crossOrigin="",u.href=l,s&&u.setAttribute("nonce",s),document.head.appendChild(u),m)return new Promise((K,Q)=>{u.addEventListener("load",K),u.addEventListener("error",()=>Q(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return d.then(a=>{for(const s of a||[])s.status==="rejected"&&i(s.reason);return n().catch(i)})},q=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],M=7,$=20;let p=null,h=new Date,T=new Date;function y(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function L(){const e=document.getElementById("calendarGrid");if(!e)return;e.innerHTML="";const n=document.createElement("div");n.className="header-cell",n.innerText="TIME",e.appendChild(n),q.forEach(t=>{const d=document.createElement("div");d.className="header-cell",d.innerText=t,e.appendChild(d)});let o=0;for(let t=M;t<=$;t++){const d=document.createElement("div");d.className="time-label",d.innerText=`${t}:00`,e.appendChild(d),q.forEach((i,a)=>{const s=document.createElement("div");s.className="slot group",s.dataset.day=a,s.dataset.hour=t,s.addEventListener("dragover",ve),s.addEventListener("dragenter",Ee),s.addEventListener("dragleave",Ie),s.addEventListener("drop",Le),s.addEventListener("click",l=>{if(s.classList.contains("just-dropped")){s.classList.remove("just-dropped");return}xe(s)});const r=c.schedule[`schedule-${a}-${t}`];if(r){const l=E(r,t);s.style.backgroundColor=l.color,s.style.color="#1f2937",s.draggable=!0,s.addEventListener("dragstart",he),s.innerHTML=`
                    <div class="class-entry-animate w-full h-full relative" style="animation-delay: ${o*.05}s">
                        ${l.weekType!=="every"?`<div class="absolute top-1 left-1 text-[8px] font-black uppercase tracking-wider text-gray-500 opacity-60 pointer-events-none select-none">${y(l.weekType)}</div>`:""}
                        ${l.location?`<div class="absolute top-1 right-1 text-[9px] font-bold text-gray-600 opacity-80 pointer-events-none select-none">${y(l.location)}</div>`:""}
                        <div class="absolute inset-0 flex flex-col justify-center items-center pointer-events-none px-1">
                            <div class="font-black text-[11px] leading-tight uppercase tracking-tight text-gray-900 line-clamp-2">${y(l.subject)}</div>
                            <div class="text-[9px] font-semibold text-gray-500 mt-0.5">${l.start}-${l.end}</div>
                        </div>
                        ${l.type?`<div class="absolute bottom-1 right-1 text-[8px] font-bold uppercase text-gray-500 tracking-wider opacity-80 pointer-events-none select-none">${y(l.type)}</div>`:""}
                    </div>
                `,o++}e.appendChild(s)})}}function I(){const e=document.getElementById("monthGrid"),n=document.getElementById("currentMonthLabel");if(!e)return;e.innerHTML="";const o=h.getFullYear(),t=h.getMonth();n&&(n.innerText=new Date(o,t).toLocaleDateString("en-US",{month:"short",year:"numeric"}));const d=new Date(o,t,1).getDay(),i=new Date(o,t+1,0).getDate(),a=new Date;for(let s=0;s<d;s++)e.appendChild(document.createElement("div"));for(let s=1;s<=i;s++){const r=document.createElement("div");r.className="month-day text-gray-700 dark:text-gray-300",r.innerText=s,s===a.getDate()&&t===a.getMonth()&&o===a.getFullYear()&&r.classList.add("today");let l=new Date(o,t,s).getDay(),m=l===0?6:l-1,g=!1;for(let u=M;u<=$;u++)c.schedule[`schedule-${m}-${u}`]&&(g=!0);if(g){const u=document.createElement("div");u.className="class-dot",r.appendChild(u)}r.addEventListener("click",()=>{document.querySelectorAll(".month-day").forEach(u=>u.classList.remove("selected-day")),r.classList.add("selected-day"),T=new Date(o,t,s),R(m,T)}),e.appendChild(r)}}function R(e,n){T=n;const o=document.getElementById("dailyOverview"),t=document.getElementById("overviewDateLabel");if(!o)return;o.innerHTML="",n&&(t.innerText=n.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}));let d=!1,i=0;for(let a=M;a<=$;a++){const s=c.schedule[`schedule-${e}-${a}`];if(s){const r=E(s,a);if(r.weekType==="even"&&!W.isEvenWeek||r.weekType==="odd"&&W.isEvenWeek)continue;d=!0;const l=document.createElement("div");l.className="class-entry-animate flex items-stretch gap-3 p-2 rounded hover:bg-gray-50 dark:hover:bg-white/5 transition",l.style.animationDelay=`${i*.1}s`,l.innerHTML=`
                <div class="w-1.5 rounded-full shadow-sm flex-shrink-0" style="background-color: ${r.color}"></div>
                <div class="flex-1 flex justify-between gap-2 py-1">
                    <div class="flex flex-col justify-center">
                        <p class="text-sm font-bold text-gray-800 dark:text-gray-200 leading-tight">${y(r.subject)}</p>
                        <div class="flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-1">
                            <span class="material-symbols-outlined text-[10px]">schedule</span>
                            <span>${r.start} - ${r.end}</span>
                        </div>
                        ${r.location?`<div class="flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-0.5"><span class="material-symbols-outlined text-[10px]">location_on</span><span>${y(r.location)}</span></div>`:""}
                    </div>
                    <div class="flex flex-col items-end gap-1">
                        ${r.type?`<span class="text-[9px] uppercase font-bold bg-gray-100 dark:bg-gray-700 text-gray-500 px-1.5 py-0.5 rounded tracking-wide">${y(r.type)}</span>`:""}
                        ${r.weekType!=="every"?`<span class="text-[8px] uppercase font-bold border border-gray-200 dark:border-gray-600 text-gray-400 px-1.5 py-0.5 rounded tracking-wide whitespace-nowrap">${y(r.weekType)} ONLY</span>`:""}
                    </div>
                </div>
            `,o.appendChild(l),i++}}d||(o.innerHTML='<div class="text-center py-2 text-gray-400 text-xs italic animate-fade-in">No classes.</div>')}function fe(){const e=document.getElementById("monthView"),n=document.getElementById("weekView"),o=document.getElementById("toggleBtnText"),t=document.getElementById("monthNav"),d=document.getElementById("calendarTitle"),i=document.getElementById("downloadScheduleBtn");e.classList.contains("hidden")?(e.classList.remove("hidden"),n.classList.add("hidden"),n.classList.remove("flex"),o.innerText="Edit",t.classList.remove("hidden"),d.innerText="Class Schedule",i.classList.add("hidden"),i.classList.remove("flex"),I()):(e.classList.add("hidden"),n.classList.remove("hidden"),n.classList.add("flex"),o.innerText="Back",t.classList.add("hidden"),d.innerText="Weekly Editor",i.classList.remove("hidden"),i.classList.add("flex"))}function ye(){document.getElementById("toggleViewBtn")?.addEventListener("click",fe),document.getElementById("prevMonth")?.addEventListener("click",()=>{h.setMonth(h.getMonth()-1),I()}),document.getElementById("nextMonth")?.addEventListener("click",()=>{h.setMonth(h.getMonth()+1),I()}),document.getElementById("closeEventModal")?.addEventListener("click",C),document.getElementById("saveEventBtn")?.addEventListener("click",F),document.getElementById("deleteEventBtn")?.addEventListener("click",z),document.getElementById("eventInput")?.addEventListener("keypress",e=>{e.key==="Enter"&&F()}),pe()}function pe(){const e=document.querySelectorAll(".color-btn");e.forEach(o=>{o.addEventListener("click",t=>{e.forEach(d=>{d.classList.remove("ring-offset-2","ring-gray-400","scale-110"),d.classList.add("ring-transparent")}),t.target.classList.remove("ring-transparent"),t.target.classList.add("ring-offset-2","ring-gray-400","scale-110"),document.getElementById("selectedColorInput").value=t.target.dataset.color})});const n=document.querySelectorAll(".week-type-btn");n.forEach(o=>{o.addEventListener("click",t=>{n.forEach(d=>d.className="week-type-btn flex-1 py-1 text-xs font-bold rounded text-gray-500 hover:text-gray-700 transition"),t.target.className="week-type-btn flex-1 py-1 text-xs font-bold rounded shadow-sm bg-white dark:bg-gray-600 text-primary transition",document.getElementById("weekTypeInput").value=t.target.dataset.val})})}function he(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/json",JSON.stringify({day:this.dataset.day,hour:this.dataset.hour})),this.style.opacity="0.4"}function ve(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1}function Ee(e){this.classList.add("drag-over")}function Ie(e){this.classList.remove("drag-over")}function Le(e){e.stopPropagation(),e.preventDefault(),this.classList.remove("drag-over");const n=e.dataTransfer.getData("application/json");if(!n)return;const o=JSON.parse(n),t=this.dataset.day,d=parseInt(this.dataset.hour),i=`schedule-${o.day}-${o.hour}`,a=`schedule-${t}-${d}`;if(o.day==t&&o.hour==d){document.querySelector(`.slot[data-day="${o.day}"][data-hour="${o.hour}"]`).style.opacity="1";return}const s=c.schedule[i];let r=s?E(s,parseInt(o.hour)):null,l=c.schedule[a]?E(c.schedule[a],d):null;if(r&&(r.start=`${d.toString().padStart(2,"0")}:00`,r.end=`${(d+1).toString().padStart(2,"0")}:00`),l){const m=parseInt(o.hour);l.start=`${m.toString().padStart(2,"0")}:00`,l.end=`${(m+1).toString().padStart(2,"0")}:00`}r?c.schedule[a]=JSON.stringify(r):delete c.schedule[a],l?c.schedule[i]=JSON.stringify(l):delete c.schedule[i],this.classList.add("just-dropped"),L(),v()}function xe(e){p=e;const n=document.getElementById("eventModal"),o=c.settings.isEvenOddEnabled==="true",t=document.getElementById("weekTypeContainer");t&&(o?t.classList.remove("hidden"):t.classList.add("hidden"));const d=parseInt(e.dataset.hour),i=c.schedule[`schedule-${e.dataset.day}-${d}`];let a={subject:"",start:`${d.toString().padStart(2,"0")}:00`,end:`${(d+1).toString().padStart(2,"0")}:00`,location:"",type:"",teacher:"",color:"#F3F4F6",weekType:"every"};i&&(a=E(i,d)),document.getElementById("eventInput").value=a.subject,document.getElementById("startTimeInput").value=a.start,document.getElementById("endTimeInput").value=a.end,document.getElementById("locationInput").value=a.location,document.getElementById("eventTypeInput").value=a.type,document.getElementById("eventTeacherInput").value=a.teacher,document.getElementById("selectedColorInput").value=a.color,document.getElementById("weekTypeInput").value=a.weekType,document.querySelectorAll(".color-btn").forEach(s=>{s.classList.remove("ring-offset-2","ring-gray-400","scale-110"),s.classList.add("ring-transparent"),s.dataset.color===a.color&&(s.classList.remove("ring-transparent"),s.classList.add("ring-offset-2","ring-gray-400","scale-110"))}),document.querySelectorAll(".week-type-btn").forEach(s=>{s.dataset.val===a.weekType?s.className="week-type-btn flex-1 py-1 text-xs font-bold rounded shadow-sm bg-white dark:bg-gray-600 text-primary transition":s.className="week-type-btn flex-1 py-1 text-xs font-bold rounded text-gray-500 hover:text-gray-700 transition"}),n.classList.remove("hidden"),n.classList.add("flex"),document.getElementById("eventInput").focus()}function C(){document.getElementById("eventModal").classList.add("hidden"),document.getElementById("eventModal").classList.remove("flex"),p=null}function F(){if(!p)return;const e=document.getElementById("eventInput").value.trim();if(e===""){z();return}const n=document.getElementById("startTimeInput").value,o=document.getElementById("endTimeInput").value,t=document.getElementById("locationInput").value.trim(),d=document.getElementById("eventTypeInput").value,i=document.getElementById("eventTeacherInput").value.trim(),a=document.getElementById("selectedColorInput").value,s=document.getElementById("weekTypeInput").value;c.subjectColors[e.toUpperCase()]=a;const r={subject:e,start:n,end:o,location:t,type:d,teacher:i,color:a,weekType:s},l=`schedule-${p.dataset.day}-${p.dataset.hour}`;c.schedule[l]=JSON.stringify(r),C(),L(),v()}function z(){if(!p)return;const e=`schedule-${p.dataset.day}-${p.dataset.hour}`;delete c.schedule[e],C(),L(),v()}let B=null,S="all",w=null;function Be(){f("addTodoBtn",H),document.getElementById("todoInput")?.addEventListener("keypress",e=>{e.key==="Enter"&&H()}),f("cancelTodoBtn",J),f("saveTodoDetailsBtn",Te),document.getElementById("filterAllBtn")?.addEventListener("click",()=>k("all")),document.getElementById("filterTodayBtn")?.addEventListener("click",()=>k("today")),document.getElementById("filterUpcomingBtn")?.addEventListener("click",()=>k("upcoming")),f("closeNoteBtn",G),f("saveNoteBtn",$e),f("cancelDeleteBtn",Y),f("confirmDeleteBtn",De),f("todoModalPinBtn",N),document.querySelectorAll(".p-btn").forEach(e=>{e.addEventListener("click",n=>{document.querySelectorAll(".p-btn").forEach(o=>o.classList.remove("selected","ring-2","ring-primary")),n.currentTarget.classList.add("selected","ring-2","ring-primary")})})}function x(){const e=document.getElementById("todoList");if(!e)return;e.innerHTML="";let n=c.advancedTodos||[],o=n;if(S==="today"){const t=new Date().toDateString();o=n.filter(d=>d.deadlineISO?new Date(d.deadlineISO).toDateString()===t:!1)}else if(S==="upcoming"){const t=new Date;t.setHours(0,0,0,0),o=n.filter(d=>{if(!d.deadlineISO)return!1;const i=new Date(d.deadlineISO);return i.setHours(0,0,0,0),i>t})}if(o.sort((t,d)=>{if(t.pinned&&!d.pinned)return-1;if(!t.pinned&&d.pinned)return 1;const i={high:3,med:2,low:1},a=i[d.priority]-i[t.priority];if(a!==0)return a;const s=t.deadlineISO?new Date(t.deadlineISO).getTime():9999999999999,r=d.deadlineISO?new Date(d.deadlineISO).getTime():9999999999999;return s-r}),o.length===0){e.innerHTML='<div class="text-center text-gray-400 mt-10 text-sm italic animate-fade-in">No tasks found.</div>';return}o.forEach((t,d)=>we(t,e,d))}function we(e,n,o=0){const t=document.createElement("div");t.className="task-item group relative flex items-center justify-between p-3 rounded-lg bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer mb-2 transform hover:-translate-y-0.5 hover:shadow-md",e.pinned&&(t.classList.add("task-pinned","border-l-4"),t.classList.remove("border-gray-100","dark:border-gray-700")),t.addEventListener("click",()=>{const r=t.classList.contains("active");document.querySelectorAll(".task-item.active").forEach(l=>l.classList.remove("active")),r||t.classList.add("active")});const d=Math.min(o*.05,.5);t.style.animationDelay=`${d}s`;let i="bg-yellow-500";e.priority==="high"&&(i="bg-red-500"),e.priority==="low"&&(i="bg-green-500");const s=e.note&&e.note.trim().length>0?"text-blue-500":"text-gray-300 dark:text-gray-600";t.innerHTML=`
        <div class="flex items-center gap-3 flex-1 min-w-0">
             ${e.pinned?'<span class="material-symbols-outlined text-xs text-primary -mr-1 rotate-45">keep</span>':""}
            <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-gray-800 dark:text-gray-200 truncate leading-snug select-text">${Ce(e.text)}</p>
                <div class="flex items-center gap-2 text-[10px] text-gray-400 mt-0.5">
                    <span>${e.deadlineText}</span>
                    <span class="hidden countdown-timer font-mono text-primary font-bold"></span>
                </div>
            </div>
        </div>
        <div class="flex items-center gap-2 shrink-0">
             <div class="flex items-center gap-1 pl-2 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto group-[.active]:opacity-100 group-[.active]:pointer-events-auto transition-all duration-200">
                <button class="note-btn p-1.5 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition ${s}"><span class="material-symbols-outlined text-lg">description</span></button>
                <button class="edit-btn text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 p-1.5 rounded-md transition"><span class="material-symbols-outlined text-lg">edit</span></button>
                <button class="delete-btn text-red-400 hover:text-red-600 p-1.5 rounded-md hover:bg-red-50 dark:hover:bg-red-900/20 transition"><span class="material-symbols-outlined text-lg">delete</span></button>
            </div>
            <div class="w-2.5 h-2.5 rounded-full ${i} shrink-0 ring-2 ring-white dark:ring-gray-700 shadow-sm ml-1"></div>
        </div>
    `,t.querySelector(".edit-btn").addEventListener("click",r=>{r.stopPropagation(),ke(e.id)}),t.querySelector(".note-btn").addEventListener("click",r=>{r.stopPropagation(),Me(e.id)}),t.querySelector(".delete-btn").addEventListener("click",r=>{r.stopPropagation(),Se(e.id)}),t.dataset.deadlineIso=e.deadlineISO,n.appendChild(t)}function be(){const e=new Date;document.querySelectorAll("#todoList > div").forEach(n=>{const o=n.dataset.deadlineIso,t=n.querySelector(".countdown-timer");if(!o||!t)return;const d=new Date(o)-e;if(d<=0)t.innerText="Overdue",t.classList.remove("hidden"),t.classList.add("text-red-500");else{t.classList.remove("hidden"),t.classList.remove("text-red-500");const i=864e5;if(d>i){const a=Math.floor(d/i),s=Math.floor(d%i/36e5);t.innerText=`${a}d ${s}h`}else{const a=Math.floor(d/36e5),s=Math.floor(d%36e5/6e4);t.innerText=`${a}h ${s}m`}}})}function k(e){S=e;const n={all:"filterAllBtn",today:"filterTodayBtn",upcoming:"filterUpcomingBtn"},o="px-4 py-1 rounded-full bg-primary/10 text-primary text-sm font-semibold transition-colors",t="px-4 py-1 rounded-full text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm font-medium transition-colors";Object.keys(n).forEach(d=>{const i=document.getElementById(n[d]);i&&(i.className=d===e?o:t)}),x()}function H(){const n=document.getElementById("todoInput").value.trim();B=null,document.getElementById("todoModalTitle").innerText="New Task",document.getElementById("todoModalNameInput").value=n,document.getElementById("todoDateInput").value="",document.getElementById("todoPinnedInput").value="true",N(),document.querySelectorAll(".p-btn").forEach(t=>t.classList.remove("selected","ring-2","ring-primary")),document.querySelector(".p-btn.med")?.classList.add("selected","ring-2","ring-primary");const o=document.getElementById("todoModal");o.classList.remove("hidden"),o.classList.add("flex")}function ke(e){const o=c.advancedTodos.find(a=>a.id==e);if(!o)return;if(B=e,document.getElementById("todoModalTitle").innerText="Edit Task",document.getElementById("todoModalNameInput").value=o.text,o.deadlineISO){const a=new Date(o.deadlineISO),s=new Date(a.getTime()-a.getTimezoneOffset()*6e4).toISOString().slice(0,16);document.getElementById("todoDateInput").value=s}else document.getElementById("todoDateInput").value="";const t=o.pinned===!0;document.getElementById("todoPinnedInput").value=(!t).toString(),N(),document.querySelectorAll(".p-btn").forEach(a=>a.classList.remove("selected","ring-2","ring-primary"));const d=document.querySelector(`.p-btn[data-priority="${o.priority}"]`);d&&d.classList.add("selected","ring-2","ring-primary");const i=document.getElementById("todoModal");i.classList.remove("hidden"),i.classList.add("flex")}function Te(){const e=document.getElementById("todoModalNameInput").value.trim();if(!e)return;const n=document.getElementById("todoDateInput").value,o=n?new Date(n):null,t=document.getElementById("todoPinnedInput").value==="true";let d="med";const i=document.querySelector(".p-btn.selected");i&&(d=i.dataset.priority);const a=c.advancedTodos;let s="";if(B){const r=a.findIndex(l=>l.id==B);r>-1&&(s=a[r].note||"",a[r].text=e,a[r].pinned=t,a[r].note=s,a[r].deadlineISO=o?o.toISOString():"",a[r].deadlineText=o?o.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"No Deadline",a[r].priority=d)}else{const r={id:Date.now(),text:e,note:"",pinned:t,deadlineISO:o?o.toISOString():"",deadlineText:o?o.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"No Deadline",priority:d};a.push(r)}c.advancedTodos=a,v(),x(),J(),document.getElementById("todoInput").value=""}function J(){document.getElementById("todoModal").classList.add("hidden"),document.getElementById("todoModal").classList.remove("flex")}function N(){const e=document.getElementById("todoPinnedInput"),n=document.getElementById("todoModalPinIcon"),o=document.getElementById("todoModalPinBtn"),t=e.value==="true";e.value=!t,t?(n.style.fontVariationSettings="'FILL' 0",o.classList.remove("text-primary"),o.classList.add("text-gray-400")):(n.style.fontVariationSettings="'FILL' 1",o.classList.add("text-primary"),o.classList.remove("text-gray-400"))}function Se(e){w=e;const n=document.getElementById("deleteModal");n.classList.remove("hidden"),n.classList.add("flex")}function Y(){document.getElementById("deleteModal").classList.add("hidden"),document.getElementById("deleteModal").classList.remove("flex"),w=null}function De(){w&&(c.advancedTodos=c.advancedTodos.filter(e=>e.id!=w),x(),v()),Y()}let b=null;function Me(e){const n=c.advancedTodos.find(t=>t.id==e);if(!n)return;b=e,document.getElementById("noteInput").value=n.note||"";const o=document.getElementById("noteModal");o.classList.remove("hidden"),o.classList.add("flex")}function G(){document.getElementById("noteModal").classList.add("hidden"),document.getElementById("noteModal").classList.remove("flex"),b=null}function $e(){if(!b)return;const e=document.getElementById("noteInput").value.trim(),n=c.advancedTodos.findIndex(o=>o.id==b);n>-1&&(c.advancedTodos[n].note=e,v(),x()),G()}function f(e,n){const o=document.getElementById(e);o&&o.addEventListener("click",n)}function Ce(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}document.addEventListener("DOMContentLoaded",()=>{X(Z,e=>{if(e)ne(e),console.log("Logged in as:",e.email),te(()=>{We(),Pe(e)});else{const n=window.location.pathname;!n.includes("/login")&&!n.includes("/signup")&&(window.location.href="/pages/login/")}}),L(),P(),I(),ye(),Be(),typeof setupPdfListeners=="function"&&setupPdfListeners(),Ne(),Oe(),U(),setInterval(()=>{U(),be()},1e3)});function Ne(){const e=document.getElementById("profileDropdownBtn"),n=document.getElementById("profileDropdownMenu"),o=document.getElementById("closeDropdownBtn"),t=document.getElementById("menuSignOutBtn"),d=document.getElementById("dropdownSettingsBtn"),i=document.getElementById("settingsModal");e&&n&&(e.addEventListener("click",a=>{a.stopPropagation(),n.classList.toggle("hidden")}),document.addEventListener("click",a=>{!e.contains(a.target)&&!n.contains(a.target)&&n.classList.add("hidden")})),o&&n&&o.addEventListener("click",a=>{a.stopPropagation(),n.classList.add("hidden")}),t&&t.addEventListener("click",async a=>{a.stopPropagation();const s=t.querySelector("p");s&&(s.innerText="Signing out..."),await ee(),window.location.href="/pages/login/"}),d&&i&&d.addEventListener("click",()=>{n.classList.add("hidden");const a=document.getElementById("setBtnAccount");a&&a.click(),i.classList.remove("hidden"),i.classList.add("flex")})}function Pe(e){const n=document.getElementById("navProfileImg"),o=document.getElementById("navProfileIcon"),t=document.getElementById("menuProfileImg"),d=document.getElementById("menuProfileIcon"),i=document.getElementById("menuUserName"),a=document.getElementById("menuUserEmail");a&&(a.innerText=e.email);const s=c.settings||{};i&&(i.innerText=s.userFirstName?s.userFirstName:e.displayName?e.displayName.split(" ")[0]:"Student");const r=s.userProfileImage;r?(n&&(n.src=r,n.classList.remove("hidden")),o&&o.classList.add("hidden"),t&&(t.src=r,t.classList.remove("hidden")),d&&d.classList.add("hidden")):(n&&n.classList.add("hidden"),o&&o.classList.remove("hidden"),t&&t.classList.add("hidden"),d&&d.classList.remove("hidden"))}function U(){const e=document.getElementById("datetimeDisplay");e&&(e.innerText=new Date().toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))}function We(){L(),I(),P();const e=new Date().getDay(),n=e===0?6:e-1;R(n,new Date),x()}function P(){const e=document.getElementById("weekDisplay");e&&ge(()=>import("./store-BI9LHzMQ.js"),__vite__mapDeps([0,1,2])).then(n=>{const o=n.userData.settings||{};if(!(o.showWeekCounter==="true")){e.classList.add("hidden");return}e.classList.remove("hidden");const d=new Date;let i=Math.ceil(((d-new Date(d.getFullYear(),0,1))/864e5+new Date(d.getFullYear(),0,1).getDay()+1)/7);i+=1;const a=o.weekParityInvert==="true";let s=i%2===0;a&&(s=!s),n.appState.isEvenWeek=s,e.innerText=s?"Week: EVEN":"Week: ODD",e.className="week-badge text-xs font-bold px-3 py-1 rounded transition-colors"})}window.initWeekCounter=P;function Oe(){const e=document.getElementById("hamburgerBtn"),n=document.getElementById("appSidebar"),o=document.getElementById("sidebarOverlay"),t=document.getElementById("closeSidebarBtn"),d=document.getElementById("sidebarSettingsBtn"),i=document.getElementById("settingsModal");function a(s){!n||!o||(s?(n.classList.remove("-translate-x-full"),o.classList.remove("hidden"),setTimeout(()=>o.classList.remove("opacity-0"),10)):(n.classList.add("-translate-x-full"),o.classList.add("opacity-0"),setTimeout(()=>o.classList.add("hidden"),300)))}e&&e.addEventListener("click",s=>{s.stopPropagation(),a(!0)}),t&&t.addEventListener("click",()=>a(!1)),o&&o.addEventListener("click",()=>a(!1)),d&&i&&d.addEventListener("click",()=>{a(!1),i.classList.remove("hidden"),i.classList.add("flex");const s=document.getElementById("setBtnAccount");s&&s.click()})}
